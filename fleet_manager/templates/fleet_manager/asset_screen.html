{% extends "fleet_manager/layout.html" %}
{% load static %}
{% load humanize %}

{% block body %}

<style>
    td.text-center {
        vertical-align: middle;
    }

    #carImage {
        width: 700px;
        height: 500px;
    }
</style>

<h2>{{ asset.year }} {{ asset.make }} {{ asset.model }}</h2><br>

<table class="table table-hover">
    <tr>
        <!-- Left Side: Image -->
        <td class="w-50 text-center align-middle">
            <div class="card d-flex align-items-center justify-content-center">
                <img src="{% static 'fleet_manager/images/default_fleet.jpg' %}" 
                     id="carImage" 
                     class="img-fluid">
            </div>
        </td>

        <!-- Right Side: Asset Details -->
        <td class="w-50 align-top">
            <br>
            <h3>Vehicle Details</h3>
            <ul>
                <li><strong>Vehicle Type:</strong> {{ asset.vehicle_type }}</li>
                <li><strong>Sub Category:</strong> {{ asset.sub_category }}</li>
                <li><strong>Classification:</strong> {{ asset.classification }}</li>
                <li><strong>Status:</strong> {{ asset.status }}</li>
                <li><strong>VIN:</strong> {{ asset.vin }}</li>
            </ul>

            {% if purchase_details %}
            <h3>Purchase Details</h3>
            <ul>
                <li><strong>Purchase Date:</strong> {{ purchase_details.purchase_date }}</li>
                <li><strong>Dealership:</strong> {{ purchase_details.dealership }}</li>
                <li><strong>Invoice No:</strong> {{ purchase_details.invoice_no }}</li>
                <li><strong>Cost Price:</strong> R{{ purchase_details.cost_price|floatformat:2|intcomma }}</li>
            </ul>
            {% else %}
            <p>No purchase details available.</p>
            {% endif %}

            {% if financing_details %}
            <h3>Financing Details</h3>
            <ul>
                {% for finance in financing_details %}
                <li><strong>Funding Institution:</strong> {{ finance.funding_institution }}</li>
                <li><strong>Loan Reference Number:</strong> {{ finance.loan_ref_number }}</li>
                <li><strong>Loan End Date:</strong> {{ finance.loan_end_date }}</li>
                <li><strong>Loan Terms:</strong> {{ finance.loan_terms }} months</li>
                <li><strong>Installments:</strong> R{{ finance.installments|floatformat:2|intcomma }}</li>
                {% empty %}
                <li>No financing details available for this asset.</li>
                {% endfor %}
            </ul>
            {% endif %}

            {% if licensing_details %}
            <h3>Licensing Details</h3>
            <ul>
                {% for license in licensing_details %}
                <li><strong>Registration Number:</strong> {{ license.reg_no }}</li>
                <li><strong>Fleet Number:</strong> {{ license.fleet_no|default:"N/A" }}</li>
                <li><strong>Renewal Fee:</strong> R{{ license.disc_fee|floatformat:2|intcomma }}</li>
                <li><strong>Expiry Date:</strong> {{ license.disc_expiry_date }}</li>
                {% empty %}
                <li>No licensing details available.</li>
                {% endfor %}
            </ul>
            {% endif %}
        </td>
    </tr>
</table>

<br />

<!-- Edit button -->
{% if user.is_superuser %}
    <button type="button" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#editAssetModal">
        Edit Asset
    </button>
    <!-- Modal for Editing Asset -->
    {% include 'fleet_manager/edit_asset_modal.html' %}
{% else %}
    <button type="button" class="btn btn-secondary" disabled>
        Edit Asset (Admin only)
    </button>
{% endif %}

<button type="button" class="btn btn-secondary disabled" data-bs-toggle="modal" data-bs-target="#editAssetModal">
    Upload Images (Coming soon...)
</button>


{% endblock %}
